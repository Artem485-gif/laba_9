import pandas as pd

# Шлях до файлу CSV
file_path = r"C:\Users\Admin\PyCharmMiscProject\API_NY.GDP.PCAP.CD_DS2_en_csv_v2_134819.csv"
output_file = r"C:\Users\Admin\PyCharmMiscProject\new_lab9.csv"

try:
    df = pd.read_csv(file_path, skiprows=4)
    print("Колонки у файлі:", df.columns.tolist())

    # Введення країн користувачем
    countries_input = input("Введіть назви країн: ")
    countries = [c.strip() for c in countries_input.split(',')]

    # Фільтруємо дані
    country_data = df[df['Country Name'].isin(countries)]

    if not country_data.empty:
        print("\nЗнайдені дані GDP per capita за 2019 рік:")
        for index, row in country_data.iterrows():
            # Перевірка на наявність колонки '2019'
            gdp_value = row.get('2019') if '2019' in df.columns else row.get('2019', 'немає даних')
            print(f"{row['Country Name']}: {gdp_value}")

        # Записуємо результати у новий файл
        year_col = '2019' if '2019' in df.columns else '2019'
        country_data[['Country Name', year_col]].to_csv(output_file, index=False)
        print(f"\nРезультат записано у файл: {output_file}")
    else:
        print("Жодну країну не знайдено у файлі.")

except FileNotFoundError:
    print(f"Файл {file_path} не знайдено!")
except pd.errors.EmptyDataError:
    print("Файл порожній!")
except pd.errors.ParserError:
    print("Помилка при розборі CSV-файлу!")
except Exception as e:
    print("Сталася невідома помилка:", e)
